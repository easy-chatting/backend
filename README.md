# Backend

## How

1) user opens the site
2) user creates a room, that room has an ID, invite link and a password (optional)
3) other users join the room via the invite link
4) users can't chat yet because the room is still _open_
5) once everyone has joined the room, any user can _lock_ the room, this will invalidate the invite link
6) when a room is locked, the clients will start negotiating a shared secret to send encrypted messages
7) users can now send encrypted messages
8) once everyone has disconnected, the room gets discarded

## Security, Encryption and Privacy

Room identifiers are unique, non-guessable 256-bit byte arrays, generated by combining a 256-bit secret with a random number into an [SHA-256 hash](https://docs.rs/sha2/0.10.6/sha2/struct.Sha256VarCore.html). The secret is generated on startup using the [ChaCha20 CSPRNG](https://rust-random.github.io/rand/rand_chacha/struct.ChaCha20Rng.html), provided by the [rand_chacha](https://github.com/rust-random/rand/tree/master/rand_chacha) crate. The random number is also generated by using a ChaCha20 CSPRNG and the SHA-256 implementation is provided by the [sha2](https://github.com/RustCrypto/hashes) crate. The code can be found in the [crypto](./src/crypto.rs) module.
